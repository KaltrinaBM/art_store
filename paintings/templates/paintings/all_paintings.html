{% extends "base.html" %}

{% block content %}
<div class="container">
    <h1>All Paintings</h1>
    <div class="row" id="paintings-container">
        {% for painting in paintings %}
            <div class="col-sm-12 col-md-6 col-lg-3 mb-4">
                <div class="card">
                    <img src="{{ painting.image.url }}" class="card-img-top" alt="{{ painting.title }}">
                    <div class="card-body">
                        <h5 class="card-title">{{ painting.title }}</h5>
                        <p class="card-text">{{ painting.description }}</p>
                        <p class="card-text"><strong>Price:</strong> ${{ painting.price }}</p>
                        <a href="{% url 'painting_detail' painting.pk %}" class="btn btn-primary">View Details</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<script>
let loadedPaintings = {{ paintings|length }};
let totalPaintings = {{ paintings|length }}; // Adjust this if you have a different method to get total paintings count

window.onscroll = function() {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight) {
        loadMorePaintings();
    }
};

function loadMorePaintings() {
    // Assuming all paintings are already loaded, this will just return as all paintings are shown.
    // Adjust this if you have more complex logic.
    if (loadedPaintings >= totalPaintings) {
        return;
    }

    // Normally, you would fetch more paintings from the server
    // Since we're showing all paintings, this will just append the same set
    const paintingsContainer = document.getElementById('paintings-container');
    for (let i = 0; i < 12; i++) {  // Arbitrary chunk size for example purposes
        const paintingCard = `
            <div class="col-sm-12 col-md-6 col-lg-3 mb-4">
                <div class="card">
                    <img src="path/to/image.jpg" class="card-img-top" alt="Painting Title">
                    <div class="card-body">
                        <h5 class="card-title">Painting Title</h5>
                        <p class="card-text">Painting Description</p>
                        <p class="card-text"><strong>Price:</strong> $Price</p>
                        <a href="painting_detail_url" class="btn btn-primary">View Details</a>
                    </div>
                </div>
            </div>
        `;
        paintingsContainer.insertAdjacentHTML('beforeend', paintingCard);
    }

    loadedPaintings += 12;  // Increase by the chunk size
}
</script>
{% endblock %}
